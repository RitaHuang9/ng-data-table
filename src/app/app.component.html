<div class="card">
  <h5>Cell Editing</h5>
  <p-table [value]="products1" dataKey="id">
    <ng-template pTemplate="header">
      <tr>
        <th *ngFor="let header of headers">
          <div class="t-hand p-d-flex p-jc-between p-ai-center">
            <p class="t-hand-title">{{ header.colName }}  </p>

            <button type="text" pButton  (click)="op.toggle($event)" icon="pi pi-search">
              <img alt="dropdown icon" class="i-formula" src="../assets/formula.png">
            </button>

            <p-overlayPanel #op [showCloseIcon]="true">
              <ng-template pTemplate>
                <input type="text" pInputText [(ngModel)]="value">
                <button pButton type="button" label="確認" class="btn" (click)="getValue(header.colName)"></button>
              </ng-template>
          </p-overlayPanel>
          </div>
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-product>
      <tr>
        <td pEditableColumn>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input pInputText type="text" [(ngModel)]="product.price"  />
            </ng-template>
            <ng-template pTemplate="output">
              {{ headers[0].colFormula ? calculateSum : product.price }}
            </ng-template>
          </p-cellEditor>
        </td>
        <td pEditableColumn>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input
                pInputText
                type="text"
                [(ngModel)]="product.quantity"
                required
              />
            </ng-template>
            <ng-template pTemplate="output">
              {{ headers[1].colFormula ?  calc(product)  : product.quantity }}
            </ng-template>
          </p-cellEditor>
        </td>
        <td pEditableColumn>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input
                pInputText
                type="text"
                [(ngModel)]="product.rating"
                required
              />
            </ng-template>
            <ng-template pTemplate="output">
              {{ headers[2].colFormula ? calculateSum : product.rating }}
            </ng-template>
          </p-cellEditor>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
<router-outlet></router-outlet>
